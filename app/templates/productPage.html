{% extends "base.html" %}

{% block content %}

<br>
<a href="{{ url_for('index.index') }}">Home</a>

<br>
<div class="dropdown">
    <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      Sellers
    </button>

    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
      {% if summary.total_stock > 0 %}
      {% for seller in sellers %}
        <div class="dropdown-item">
          {{seller.firstname}} {{seller.lastname}}  
          <small class="text-muted">(Price: {{seller.price}}; Stock: {{seller.stock}})</small>
          
          {% if current_user.is_authenticated %}
          <form action="{{ url_for('cartRouter.add_cart', user_id=current_user.id, seller_id=seller.seller_id, product_id=product.id, quantity = "0") }}" method="POST"> 
            <input type="number" id="quantity" name="quantity" required
                min="1" max="{{seller.stock}}"> 
            <input type="submit" value="Add to Cart">
          </form>
          {% endif %}
        </div>

      {% endfor %}
      {% else %}
      <div class="dropdown-item">
        No current listings
      </div>
        
      {% endif %}


    </div>
  </div>
<div style="text-align: center">

		<h2> {{summary.name}} </h2>
    <img src="{{product.image_file}}">
        <h2> {{summary.avg_rating}} Stars </h2>
        <p>ID: {{summary.product_id}}</p>
		{% if summary.total_stock > 0 %}
		    <h5 style="font-size: 24px; color:green"> In Stock</h5>
    {%else%}
            <h5 style="font-size: 24px; color:red"> Out of Stock </h5>
    {%endif%}   
		<h5>Category: {{summary.cat_name}}</h5>
		<h5>Average Price: {{summary.avg_price}}</h5>
    <h5>Total Stock: {{summary.total_stock}}</h5>
		<h5>Description: {{summary.description}}</h5>
</div>

		<h5>Reviews: ({{summary.reviews}}) </h5>
        {% if reviews %}
        <div class="card-columns">
        {% for review in reviews %}
            <div class="card" style="max-width: 18rem;">
              <div class="card-body" onclick="window.location.href='{{ url_for('index.review_history', page=0, type='product_history', product_id=product.id)}}'">
                <h5 class="card-title">Rating: {{review.rating}}</h5>
                <p class="card-text">User: {{review.firstname}} {{review.lastname}} </p>
                <p class="card-text">Description: {{review.description}}</p>
                <p class="card-text"><small class="text-muted">{{review.date_time}}</small></p>
              </div>
            </div>
        {% endfor %}
        </div>

        {% endif %}
<br><br><br>
{% endblock %}
